<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shooting Scores</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .menu {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .btn:hover {
            background-color: #45a049;
        }
        
        .clear-btn {
            padding: 8px 12px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        
        .clear-btn:hover {
            background-color: #d32f2f;
        }
        
        .content {
            min-height: 200px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .numpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .num-btn {
            position: relative;
            height: 60px;
            font-size: 24px;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .num-btn:hover {
            background-color: #e0e0e0;
        }
        
        .counter {
            position: absolute;
            bottom: 3px;
            right: 5px;
            font-size: 12px;
            color: #666;
        }
        
        .score-display {
            font-size: 24px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .shots-list {
            margin-bottom: 15px;
            border: 1px solid #eee;
            padding: 10px;
            word-wrap: break-word;
            line-height: 1.6;
        }
        
        .shot-chip {
            display: inline-block;
            padding: 2px 8px;
            margin: 2px;
            background-color: #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
        }
        
        .shot-chip:hover {
            background-color: #f44336;
            color: white;
        }
        
        .history-item {
            padding: 10px;
            margin-bottom: 5px;
            background-color: #f9f9f9;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-container {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        
        .score-info {
            text-align: center;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 4px;
            margin: 15px 0;
            font-size: 18px;
        }
        
        .remove-btn {
            padding: 2px 6px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .remove-btn:hover {
            background-color: #d32f2f;
        }
    </style>
</head>
<body>
    <div class="menu">
        <button id="summary-btn" class="btn">Summary</button>
        <button id="calculate-btn" class="btn">Calculator</button>
        <button id="new-target-btn" class="btn">New target</button>
    </div>
    
    <div id="content" class="content">
        <div id="calculate-view">
            <div class="history-container">
                <div id="mini-history-list">
                    <!-- History items will be listed here -->
                </div>
            </div>
            
            <!-- <div class="score-display">
                Current Target
            </div> -->
            <div id="shots-list" class="shots-list">
                <!-- Shot values will be listed here -->
            </div>
            
            <button id="clear-target-btn" class="clear-btn">Clear</button>
        </div>
        
        <div id="summary-view" style="display: none;">
            <h2>Target History</h2>
            <div id="history-list">
                <!-- History items will be listed here -->
            </div>
        </div>
    </div>
    
    <div id="score-info" class="score-info">
        Score: <span id="current-score">0/0</span> <span id="shots-count-container" style="display: none;">| Shots: <span id="shots-count">0</span></span>
    </div>
    
    <div id="numpad" class="numpad">
        <button class="num-btn" data-value="1">1<span class="counter" id="count-1">0</span></button>
        <button class="num-btn" data-value="2">2<span class="counter" id="count-2">0</span></button>
        <button class="num-btn" data-value="3">3<span class="counter" id="count-3">0</span></button>
        <button class="num-btn" data-value="4">4<span class="counter" id="count-4">0</span></button>
        <button class="num-btn" data-value="5">5<span class="counter" id="count-5">0</span></button>
        <button class="num-btn" data-value="6">6<span class="counter" id="count-6">0</span></button>
        <button class="num-btn" data-value="7">7<span class="counter" id="count-7">0</span></button>
        <button class="num-btn" data-value="8">8<span class="counter" id="count-8">0</span></button>
        <button class="num-btn" data-value="9">9<span class="counter" id="count-9">0</span></button>
        <button class="num-btn" data-value="10">10<span class="counter" id="count-10">0</span></button>
        <button class="num-btn" data-value="0">0<span class="counter" id="count-0">0</span></button>
        <button class="num-btn" id="backspace">âŒ«</button>
    </div>

    <script>
        // State variables
        let currentTarget = {
            shots: [],
            counters: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0}
        };
        let targetHistory = [];
        
        // DOM Elements
        const calculateView = document.getElementById('calculate-view');
        const summaryView = document.getElementById('summary-view');
        const numpadElement = document.getElementById('numpad');
        const currentScoreElement = document.getElementById('current-score');
        const shotsCountElement = document.getElementById('shots-count');
        const shotsCountContainer = document.getElementById('shots-count-container');
        const shotsListElement = document.getElementById('shots-list');
        const historyListElement = document.getElementById('history-list');
        const miniHistoryListElement = document.getElementById('mini-history-list');
        const clearTargetBtn = document.getElementById('clear-target-btn');
        
        // Load data from localStorage
        function loadData() {
            const savedHistory = localStorage.getItem('targetHistory');
            if (savedHistory) {
                targetHistory = JSON.parse(savedHistory);
                updateHistoryView();
                updateMiniHistoryView();
            }
            
            const savedTarget = localStorage.getItem('currentTarget');
            if (savedTarget) {
                currentTarget = JSON.parse(savedTarget);
                updateScoreDisplay();
                updateShotsList();
                updateCounters();
            }
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('targetHistory', JSON.stringify(targetHistory));
            localStorage.setItem('currentTarget', JSON.stringify(currentTarget));
        }
        
        // Update score display
        function updateScoreDisplay() {
            const sum = currentTarget.shots.reduce((total, shot) => total + shot, 0);
            const total = currentTarget.shots.length * 10;
            currentScoreElement.textContent = `${sum}/${total}`;
            shotsCountElement.textContent = currentTarget.shots.length;
            
            // Show shot count only if there are shots
            if (currentTarget.shots.length > 0) {
                shotsCountContainer.style.display = 'inline';
            } else {
                shotsCountContainer.style.display = 'none';
            }
        }
        
        // Update shots list
        function updateShotsList() {
            shotsListElement.innerHTML = '';
            
            if (currentTarget.shots.length === 0) {
                shotsListElement.textContent = 'Enter your points';
                return;
            }
            
            currentTarget.shots.forEach((shot, index) => {
                const shotChip = document.createElement('span');
                shotChip.className = 'shot-chip';
                shotChip.textContent = shot;
                shotChip.dataset.index = index;
                shotChip.title = 'Click to remove this shot';
                shotChip.addEventListener('click', (e) => {
                    removeShot(parseInt(e.target.dataset.index));
                });
                shotsListElement.appendChild(shotChip);
            });
        }
        
        // Update numpad counters
        function updateCounters() {
            for (const value in currentTarget.counters) {
                const counterElement = document.getElementById(`count-${value}`);
                if (counterElement) {
                    counterElement.textContent = currentTarget.counters[value];
                }
            }
        }
        
        // Update history view
        function updateHistoryView() {
            historyListElement.innerHTML = '';
            targetHistory.forEach((target, index) => {
                const sum = target.shots.reduce((total, shot) => total + shot, 0);
                const total = target.shots.length * 10;
                
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                const shotsDiv = document.createElement('div');
                shotsDiv.textContent = target.shots.join(', ');
                
                const scoreDiv = document.createElement('div');
                scoreDiv.innerHTML = `<strong>${sum}/${total}</strong>`;
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-btn';
                removeBtn.textContent = 'X';
                removeBtn.dataset.index = index;
                removeBtn.addEventListener('click', (e) => {
                    removeTarget(parseInt(e.target.dataset.index));
                });
                
                historyItem.appendChild(shotsDiv);
                historyItem.appendChild(scoreDiv);
                historyItem.appendChild(removeBtn);
                
                historyListElement.appendChild(historyItem);
            });
        }
        
        // Update mini history view for main screen
        function updateMiniHistoryView() {
            miniHistoryListElement.innerHTML = '';
            targetHistory.forEach((target, index) => {
                const sum = target.shots.reduce((total, shot) => total + shot, 0);
                const total = target.shots.length * 10;
                
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                const shotsDiv = document.createElement('div');
                shotsDiv.textContent = target.shots.join(', ');
                
                const scoreDiv = document.createElement('div');
                scoreDiv.innerHTML = `<strong>${sum} / ${total}</strong>`;
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-btn';
                removeBtn.textContent = 'X';
                removeBtn.dataset.index = index;
                removeBtn.addEventListener('click', (e) => {
                    removeTarget(parseInt(e.target.dataset.index));
                });
                
                historyItem.appendChild(shotsDiv);
                historyItem.appendChild(scoreDiv);
                historyItem.appendChild(removeBtn);
                
                miniHistoryListElement.appendChild(historyItem);
            });
        }
        
        // Add a shot to the current target
        function addShot(value) {
            currentTarget.shots.push(value);
            currentTarget.counters[value]++;
            updateScoreDisplay();
            updateShotsList();
            updateCounters();
            saveData();
        }
        
        // Remove a specific shot
        function removeShot(index) {
            if (index >= 0 && index < currentTarget.shots.length) {
                const removedShot = currentTarget.shots[index];
                currentTarget.shots.splice(index, 1);
                currentTarget.counters[removedShot]--;
                updateScoreDisplay();
                updateShotsList();
                updateCounters();
                saveData();
            }
        }
        
        // Remove the last shot
        function removeLastShot() {
            if (currentTarget.shots.length > 0) {
                const lastShot = currentTarget.shots.pop();
                currentTarget.counters[lastShot]--;
                updateScoreDisplay();
                updateShotsList();
                updateCounters();
                saveData();
            }
        }
        
        // Clear the current target without saving
        function clearCurrentTarget() {
            if (currentTarget.shots.length > 0) {
                currentTarget = {
                    shots: [],
                    counters: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0}
                };
                updateScoreDisplay();
                updateShotsList();
                updateCounters();
                saveData();
            }
        }
        
        // Remove a target from history
        function removeTarget(index) {
            if (index >= 0 && index < targetHistory.length) {
                targetHistory.splice(index, 1);
                updateHistoryView();
                updateMiniHistoryView();
                saveData();
            }
        }
        
        // Create a new target
        function createNewTarget() {
            if (currentTarget.shots.length > 0) {
                targetHistory.push({...currentTarget});
                currentTarget = {
                    shots: [],
                    counters: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0}
                };
                updateScoreDisplay();
                updateShotsList();
                updateCounters();
                updateHistoryView();
                updateMiniHistoryView();
                saveData();
            }
        }
        
        // Switch to Summary view
        function showSummaryView() {
            calculateView.style.display = 'none';
            summaryView.style.display = 'block';
            numpadElement.style.display = 'none';
            document.getElementById('score-info').style.display = 'none';
            updateHistoryView();
        }
        
        // Switch to Calculate view
        function showCalculateView() {
            calculateView.style.display = 'block';
            summaryView.style.display = 'none';
            numpadElement.style.display = 'grid';
            document.getElementById('score-info').style.display = 'block';
        }
        
        // Event Listeners
        document.querySelectorAll('.num-btn').forEach(button => {
            if (button.id !== 'backspace') {
                button.addEventListener('click', () => {
                    const value = parseInt(button.dataset.value);
                    addShot(value);
                });
            }
        });
        
        document.getElementById('backspace').addEventListener('click', removeLastShot);
        document.getElementById('new-target-btn').addEventListener('click', createNewTarget);
        document.getElementById('summary-btn').addEventListener('click', showSummaryView);
        document.getElementById('calculate-btn').addEventListener('click', showCalculateView);
        document.getElementById('clear-target-btn').addEventListener('click', clearCurrentTarget);
        
        // Initialize app
        loadData();
    </script>
</body>
</html>